%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{ПОСТАНОВКА ЗАДАЧИ, ВЫБОР СПОСОБА РЕШЕНИЯ}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

В современном мире коммуникации через интернет очень удобны. Такие коммуникации особенно будут экономить время, если их встроить в бизнес-системы. Но для бизнес-систем это не столь необходимо, как для CRM-систем.

В CRM-системах звонки занимают одну из центральных ролей для успешного бизнеса. У каждой CRM-системы имеется модуль Звонки, который для каждого звонка создаёт карточку. В ней можно записывать информацию о звонке, определить его значение (сделка, покупка, продажа и т.п.). Такие модули Звонков могут хранить историю о звонках, на основе которой будет составляться статистика, которая полезна управляющему персоналу компании. Для них важно знать сколько сделок совершили операторы, кто из них лучший. Функция записи звонков позволит выявлять плохих и хороших работников.

Из раздела \ref{section:review} понятно, что в бизнес-системах и CRM-системах есть пробелы в удобстве организации VoIP-телефонии в браузере. Поэтому постараемся заполнить эти пробелы разработкой модуля VoIP-телефонии для web-браузера.

\section{Постановка задачи}

Итак, необходимо разработать модуль VoIP-телефонии для web-браузера. Данный модуль будет выполнять функцию телефона (софт-фона), который будет доступен прямо со страницы web-приложения. Так же данный модуль будет решением с отрытым исходным кодом. Это позволит тем кто его использует настраивать его под свои задачи.

Установим следующие требования к модулю:
\begin{enumerate}
\item Поддержка современными web-браузерами: Firefox, Google Chrome, Safary, Edge, IE, Opera, Android Browser, Chrome for Android, Bowser.
\item Модуль должен быть универсальным, и легко встраиваться в бизнес-системы и CRM-системы.
\item Модуль должен полностью контролировать состояние звонка.
\end{enumerate}

Обычно софт-фоны поддерживают передачу видео, аудио и мгновенных сообщений. Однако CRM-системах видео-звонки практически не требуется. Поэтому в данной работе ограничимся передачей аудио потока.

Графический интерфейс должен состоять из скользящей кнопки и плавающего окна, которое появляется и скрывается по нажатию на эту кнопку. Плавающее окно должно включать поле для набора номера и кнопки "вызов" и "сброс", которые должны меняются во время входящего звонка на кнопки "снять трубку" и "отклонить звонок" соответственно. То есть графический интерфейс должен реагировать на состояние звонка. Приведём ещё один пример. Графический интерфейс должен запрещать пользователю нажимать на кнопку сброса пока звонок ещё не начался.

\section{Выбор способа решения}

Как было рассмотренно в разделе \ref{subsection:reviewWebRTC} лучшей на сегодня технологией для организации VoIP-телефона в браузере является WebRTС. Данная технология встроенна в браузер и доступ к её компонентам имеется только с помощью JavaScript, который выполняется на web-странице. Поэтому разработка клиентской части будет реализованна на JavaScript.

Для обмена в VoIP-телефонии существуют два протокола H323 и SIP. По технологии WebRTC имеются только две реализации SIP протокола --- это библиотеки sipML5 и JsSIP. Реализации протокола H323 на сегодняшний день нет, поэтому этот протокол мы рассматривать не будем.

\subsection{Сравнительный анализ библиотек sipML5 и JsSIP}

Функциональные возможности библиотек sipML5 и JsSIP представленны в таблице \ref{table:sipml5_vs_jssip}.\cite{sipML5}\cite{JsSIP}

\begin{table}
	\caption{Функциональные возможности библиотек sipML5 и JsSIP}
	\begin{center}
	\begin{tabular}{|l|c|c|}
	\hline 
	\textbf{Функциональная возможность} & \textbf{sipML5} & \textbf{JsSIP}	\\ 
	\hline 
	аудио звонки & + & + \\ 
	\hline 
	видео звонки & + & + \\ 
	\hline 
	мгновенные сообщения & + & + \\ 
	\hline 
	статус присутствия в сети & + & + \\ 
	\hline 
	удержание вызова & + & + \\ 
	\hline 
	отключение микрофона & + & + \\ 
	\hline 
	тональный набор (DTMF) & + & + \\ 
	\hline 
	трансляция экрана & только для Chrome & - \\ 
	\hline 
	групповой звонок & + & - \\ 
	\hline 
	перенаправление вызова & + & - \\ 
	\hline 
	\end{tabular} 
	\end{center}
	\label{table:sipml5_vs_jssip}
\end{table}

Обе библиотеки имеют хорошую документацию. Размер библиотеки JsSIP ~130kb. Размер библиотеки sipML5 чуть больше 1Mb. Однако JsSIP требует установки Node.js на сервере.

Обе библиотеки имеют свои преимущества, но для нашей задачи выберем библиотеку sipML5, потому что функциональных возможностей у неё больше и не нужно дополнительно устанавливать Node.js на сервер.

\section{Резюме}

В данном разделе была поставлена задача разработки модуля SIP-телефонии для web-браузера, определены основные требования. Для разработки была выбрана технология WebRTC и библиотека sipML5 для осуществления звонков по протоколу SIP.